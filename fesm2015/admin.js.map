{"version":3,"file":"admin.js","sources":["../../../../../../src/ionic/admin/admin-user-interactions.ts","../../../../../../src/ionic/admin/edit.ts","../../../../../../src/ionic/admin/input-type-pipe.ts","../../../../../../src/ionic/admin/list.ts","../../../../../../src/ionic/admin/admin-module.ts","../../../../../../src/ionic/admin/public-api.ts","../../../../../../src/ionic/admin/index.ts"],"sourcesContent":["/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Gnucoop Angular Toolkit (gngt).\n *\n * Gnucoop Angular Toolkit (gngt) is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Gnucoop Angular Toolkit (gngt) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Gnucoop Angular Toolkit (gngt).  If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Injectable} from '@angular/core';\nimport {AdminUserInteractionsService as CoreAdminUserInteractionsService} from '@gngt/core/admin';\nimport {AlertController} from '@ionic/angular';\nimport {OverlayEventDetail} from '@ionic/core';\nimport {TranslateService} from '@ngx-translate/core';\nimport {from, Observable} from 'rxjs';\nimport {map, mapTo, switchMap} from 'rxjs/operators';\n\n@Injectable()\nexport class AdminUserInteractionsService extends CoreAdminUserInteractionsService {\n  constructor(private _alert: AlertController, private _ts: TranslateService) {\n    super();\n  }\n\n  askDeleteConfirm(): Observable<boolean> {\n    const strings = ['Are you sure you want to delete?', 'Cancel', 'Ok'];\n    return this._ts.get(strings).pipe(\n        switchMap(ts => from(this._alert.create({\n                    message: ts[0],\n                    buttons: [{text: ts[1], role: 'cancel'}, {text: ts[2], role: 'confirm'}]\n                  }))),\n        switchMap(alert => from((alert as HTMLIonAlertElement).present()).pipe(mapTo(alert))),\n        switchMap(alert => from((alert as HTMLIonAlertElement).onDidDismiss())),\n        map(evt => (evt as OverlayEventDetail<any>).role === 'confirm'),\n    );\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Gnucoop Angular Toolkit (gngt).\n *\n * Gnucoop Angular Toolkit (gngt) is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Gnucoop Angular Toolkit (gngt) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Gnucoop Angular Toolkit (gngt).  If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {BooleanInput} from '@angular/cdk/coercion';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ViewEncapsulation\n} from '@angular/core';\nimport {FormBuilder} from '@angular/forms';\nimport {Router} from '@angular/router';\nimport {AdminEditComponent as BaseAdminEditComponent} from '@gngt/core/admin';\nimport {Model} from '@gngt/core/common';\nimport {ModelActionTypes, State as ModelState} from '@gngt/core/model';\n\n@Component({\n  selector: 'gngt-admin-edit',\n  templateUrl: 'edit.html',\n  styleUrls: ['edit.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AdminEditComponent<\n    T extends Model = Model, S extends ModelState<T> = ModelState<T>, A extends\n        ModelActionTypes = ModelActionTypes> extends BaseAdminEditComponent<T, S, A> {\n  constructor(cdr: ChangeDetectorRef, fb: FormBuilder, router: Router) {\n    super(cdr, fb, router);\n  }\n\n  static ngAcceptInputType_canSave: BooleanInput;\n  static ngAcceptInputType_hideSaveButton: BooleanInput;\n  static ngAcceptInputType_readonly: BooleanInput;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Gnucoop Angular Toolkit (gngt).\n *\n * Gnucoop Angular Toolkit (gngt) is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Gnucoop Angular Toolkit (gngt) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Gnucoop Angular Toolkit (gngt).  If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\nimport {AdminEditFieldSubtype} from '@gngt/core/admin';\nimport {TextFieldTypes} from '@ionic/core';\n\nconst validTypes = ['date', 'email', 'number', 'password', 'search', 'tel', 'text', 'url', 'time'];\n\n@Pipe({name: 'gngtInputType'})\nexport class InputTypePipe implements PipeTransform {\n  transform(value: AdminEditFieldSubtype|undefined): TextFieldTypes {\n    if (value != null && validTypes.indexOf(value) > -1) {\n      return value as TextFieldTypes;\n    }\n    return 'text';\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Gnucoop Angular Toolkit (gngt).\n *\n * Gnucoop Angular Toolkit (gngt) is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Gnucoop Angular Toolkit (gngt) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Gnucoop Angular Toolkit (gngt).  If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Input,\n  OnDestroy,\n  OnInit,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {AdminListComponent as BaseAdminListComponent} from '@gngt/core/admin';\nimport {mergeQueryParams, Model, ModelQueryParams} from '@gngt/core/common';\nimport {ModelActionTypes, ModelService, State as ModelState} from '@gngt/core/model';\nimport {IonInfiniteScroll} from '@ionic/angular';\nimport {Subscription} from 'rxjs';\nimport {filter} from 'rxjs/operators';\n\nimport {AdminUserInteractionsService} from './admin-user-interactions';\n\n@Component({\n  selector: 'gngt-admin-list',\n  templateUrl: 'list.html',\n  styleUrls: ['list.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AdminListComponent<T extends Model = Model, S extends ModelState<T> = ModelState<T>,\n                                                                   A extends\n                                    ModelActionTypes = ModelActionTypes, MS extends\n                                        ModelService<T, S, A> = ModelService<T, S, A>> extends\n    BaseAdminListComponent<T, S, A, MS> implements OnDestroy, OnInit {\n  @Input() baseQueryParams: Partial<ModelQueryParams>;\n  @ViewChild(IonInfiniteScroll) infiniteScroll: IonInfiniteScroll;\n\n  private _items: T[] = [];\n  get items(): T[] {\n    return this._items;\n  }\n\n  private _hasMore: boolean = true;\n  get hasMore(): boolean {\n    return this._hasMore;\n  }\n\n  private _querySub: Subscription = Subscription.EMPTY;\n  private _queryParams: Partial<ModelQueryParams> = {start: 0, limit: 20, sort: {}};\n\n  constructor(cdr: ChangeDetectorRef, aui: AdminUserInteractionsService) {\n    super(cdr, aui);\n  }\n\n  override ngOnDestroy(): void {\n    super.ngOnDestroy();\n    this._querySub.unsubscribe();\n  }\n\n  ngOnInit(): void {\n    const service = this._getService();\n\n    if (service == null) {\n      return;\n    }\n\n    this._querySub = service.getListObjects()\n                         .pipe(\n                             filter(r => r != null),\n                             )\n                         .subscribe(r => {\n                           if (this.infiniteScroll) {\n                             (this.infiniteScroll as any).complete();\n                           }\n                           this._items = [...this._items, ...(r!.results || [])];\n                           this._hasMore = r!.next != null;\n                           this._cdr.markForCheck();\n                         });\n\n    this._loadList();\n  }\n\n  getSelection(): T[] {\n    return [];\n  }\n\n  getItems(): T[] {\n    return [];\n  }\n\n  clearSelection(): void {}\n\n  selectAll(): void {}\n\n  refreshList(): void {\n    this._queryParams.start = 0;\n    this._loadList();\n  }\n\n  loadMore(): void {\n    this._queryParams.start! += this._queryParams.limit!;\n    this._loadList();\n  }\n\n  private _loadList(): void {\n    const service = this._getService();\n    if (service == null || !this._hasMore) {\n      return;\n    }\n    const queryParams = mergeQueryParams(this._queryParams, this.baseQueryParams || {});\n    service.query(queryParams);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Gnucoop Angular Toolkit (gngt).\n *\n * Gnucoop Angular Toolkit (gngt) is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Gnucoop Angular Toolkit (gngt) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Gnucoop Angular Toolkit (gngt).  If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CommonModule} from '@angular/common';\nimport {NgModule} from '@angular/core';\nimport {ReactiveFormsModule} from '@angular/forms';\nimport {RouterModule} from '@angular/router';\nimport {GicModule} from '@gic/angular';\nimport {GngtAdminModule as CoreModule} from '@gngt/core/admin';\nimport {CommonModule as GngtCommonModule} from '@gngt/core/common';\nimport {IonicModule} from '@ionic/angular';\nimport {TranslateModule} from '@ngx-translate/core';\n\nimport {AdminUserInteractionsService} from './admin-user-interactions';\nimport {AdminEditComponent} from './edit';\nimport {InputTypePipe} from './input-type-pipe';\nimport {AdminListComponent} from './list';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    CoreModule,\n    GicModule,\n    GngtCommonModule,\n    IonicModule,\n    ReactiveFormsModule,\n    RouterModule,\n    TranslateModule,\n  ],\n  declarations: [\n    AdminEditComponent,\n    AdminListComponent,\n    InputTypePipe,\n  ],\n  exports: [\n    AdminEditComponent,\n    AdminListComponent,\n  ],\n  providers: [\n    AdminUserInteractionsService,\n  ]\n})\nexport class AdminModule {\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Gnucoop Angular Toolkit (gngt).\n *\n * Gnucoop Angular Toolkit (gngt) is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Gnucoop Angular Toolkit (gngt) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Gnucoop Angular Toolkit (gngt).  If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport * from './admin-module';\nexport * from './admin-user-interactions';\nexport * from './edit';\nexport * from './list';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {InputTypePipe as ɵgc_gngt_src_ionic_admin_admin_a} from './input-type-pipe';"],"names":["CoreAdminUserInteractionsService","BaseAdminEditComponent","BaseAdminListComponent","CoreModule","GngtCommonModule"],"mappings":"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"}