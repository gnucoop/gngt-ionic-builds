{"version":3,"file":"auth.es5.js","sources":["../../../src/ionic/auth/auth-module.ts","../../../src/ionic/auth/login.ts","../../../src/ionic/auth/auth-user-interactions.ts"],"sourcesContent":["/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Gnucoop Angular Toolkit (gngt).\n *\n * Gnucoop Angular Toolkit (gngt) is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Gnucoop Angular Toolkit (gngt) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Gnucoop Angular Toolkit (gngt).  If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {CommonModule} from '@angular/common';\nimport {HTTP_INTERCEPTORS} from '@angular/common/http';\nimport {ModuleWithProviders, NgModule} from '@angular/core';\nimport {ReactiveFormsModule} from '@angular/forms';\n\nimport {AlertController, IonicModule, ToastController} from '@ionic/angular';\n\nimport {TranslateModule, TranslateService} from '@ngx-translate/core';\n\nimport {CommonModule as CoreCommonModule} from '@gngt/core/common';\nimport {\n  AUTH_OPTIONS, AuthModule as CoreAuthModule, AuthModuleOptions,\n  AuthUserInteractionsService as CoreAuthUserInteractionsService,\n  JWT_OPTIONS, JwtHelperService, JwtInterceptor\n} from '@gngt/core/auth';\nimport {CommonModule as IonicCommonModule} from '@gngt/ionic/common';\n\nimport {AuthUserInteractionsService} from './auth-user-interactions';\nimport {LoginComponent} from './login';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    ReactiveFormsModule,\n    IonicModule,\n    TranslateModule,\n    CoreCommonModule,\n    IonicCommonModule,\n    CoreAuthModule\n  ],\n  declarations: [\n    LoginComponent,\n  ],\n  exports: [\n    LoginComponent\n  ],\n  providers: [\n    {\n      provide: CoreAuthUserInteractionsService,\n      useClass: AuthUserInteractionsService,\n      deps: [TranslateService, AlertController, ToastController]\n    }\n  ]\n})\nexport class AuthModule {\n  static forRoot(options: AuthModuleOptions): ModuleWithProviders {\n    return {\n      ngModule: AuthModule,\n      providers: [\n        {\n          provide: HTTP_INTERCEPTORS,\n          useClass: JwtInterceptor,\n          multi: true\n        },\n        options.jwtOptionsProvider ||\n        {\n          provide: JWT_OPTIONS,\n          useValue: options.jwtConfig\n        },\n        options.authOptionsProvider ||\n        {\n          provide: AUTH_OPTIONS,\n          useValue: options.authConfig\n        },\n        JwtHelperService\n      ]\n    };\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Gnucoop Angular Toolkit (gngt).\n *\n * Gnucoop Angular Toolkit (gngt) is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Gnucoop Angular Toolkit (gngt) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Gnucoop Angular Toolkit (gngt).  If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  ChangeDetectorRef, ChangeDetectionStrategy, Component, ViewEncapsulation\n} from '@angular/core';\nimport {FormBuilder} from '@angular/forms';\n\nimport {Store} from '@ngrx/store';\n\nimport {LoginComponent as CoreLoginComponent, reducers as fromAuth} from '@gngt/core/auth';\n\n@Component({\n  moduleId: module.id,\n  selector: 'gngt-login',\n  templateUrl: 'login.html',\n  styleUrls: ['login.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n  inputs: ['disabled']\n})\nexport class LoginComponent extends CoreLoginComponent {\n  constructor(fb: FormBuilder, store: Store<fromAuth.State>, cdr: ChangeDetectorRef) {\n    super(fb, store, cdr);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Gnucoop Angular Toolkit (gngt).\n *\n * Gnucoop Angular Toolkit (gngt) is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Gnucoop Angular Toolkit (gngt) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Gnucoop Angular Toolkit (gngt).  If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AlertController, ToastController} from '@ionic/angular';\n\nimport {from, Observable} from 'rxjs';\nimport {map, mapTo, switchMap} from 'rxjs/operators';\n\nimport {TranslateService} from '@ngx-translate/core';\n\nimport {AuthUserInteractionsService as CoreAuthUserInteractionsService} from '@gngt/core/auth';\n\nexport class AuthUserInteractionsService extends CoreAuthUserInteractionsService {\n  constructor(\n    private _ts: TranslateService, private _alert: AlertController, private _toast: ToastController\n  ) {\n    super();\n  }\n\n  askLogoutConfirm(): Observable<boolean> {\n    const strings = [\n      'Are you sure you want to logout?',\n      'Cancel',\n      'Ok'\n    ];\n    return this._ts.get(strings).pipe(\n      switchMap(ts => from(this._alert.create({\n        message: ts[0],\n        buttons: [{text: ts[1], role: 'cancel'}, {text: ts[2], role: 'confirm'}]\n      }))),\n      switchMap(alert => from(alert.present()).pipe(mapTo(alert))),\n      switchMap(alert => from(alert.onDidDismiss())),\n      map(evt => evt.role === 'confirm')\n    );\n  }\n\n  showLoginError(error: string): void {\n    this._toast.create({\n      message: error,\n      showCloseButton: false,\n      duration: 3000\n    }).then(t => t.present());\n  }\n}\n"],"names":["CoreAuthUserInteractionsService","CoreAuthModule","IonicCommonModule","CoreCommonModule","tslib_1.__extends"],"mappings":"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"}